<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code-X - Learn to Code</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <nav class="navbar animate-fadeInDown">
            <div class="nav-brand">
                <h1>Code<span class="accent">-X</span></h1>
            </div>
        </nav>

        <main class="landing-main">
            <div class="hero-section">
                <div class="hero-content">
                    <h1 class="hero-title animate-fadeInUp">Become a <span class="accent typewriter">Master Coder</span></h1>
                    <p class="hero-subtitle animate-fadeInUp" style="animation-delay: 0.2s">Learn HTML, CSS, and JavaScript through 300+ interactive coding challenges. Track your progress, earn achievements, and build real projects.</p>
                    
                    <div class="hero-stats animate-fadeInUp" style="animation-delay: 0.4s">
                        <div class="stat stagger-item">
                            <h3>300+</h3>
                            <p>Coding Levels</p>
                        </div>
                        <div class="stat stagger-item">
                            <h3>3</h3>
                            <p>Languages</p>
                        </div>
                        <div class="stat stagger-item">
                            <h3>50+</h3>
                            <p>Achievements</p>
                        </div>
                    </div>

                    <!-- Continue Progress Section -->
                    <div class="continue-section animate-fadeInUp" id="continueSection" style="display: none; animation-delay: 0.6s">
                        <div class="continue-card hover-lift">
                            <h3>Continue Your Journey</h3>
                            <p>Pick up where you left off</p>
                            <button id="continueButton" class="btn btn-primary btn-large hover-glow">Continue Learning</button>
                        </div>
                    </div>

                    <div class="auth-section animate-fadeInUp" style="animation-delay: 0.8s">
                        <div class="auth-tabs">
                            <button class="auth-tab active" data-tab="login">Login</button>
                            <button class="auth-tab" data-tab="register">Register</button>
                        </div>

                        <div class="auth-forms">
                            <form id="loginForm" class="auth-form active">
                                <div class="form-group">
                                    <input type="email" id="loginEmail" placeholder="Email" required>
                                    <div class="validation-message" id="loginEmailError"></div>
                                </div>
                                <div class="form-group">
                                    <input type="password" id="loginPassword" placeholder="Password" required>
                                    <div class="validation-message" id="loginPasswordError"></div>
                                </div>
                                <button type="submit" class="btn btn-primary btn-large" id="loginButton">
                                    <span class="button-text">Login</span>
                                    <div class="loading-spinner" style="display: none"></div>
                                </button>
                            </form>

                            <form id="registerForm" class="auth-form">
                                <div class="form-group">
                                    <input type="text" id="registerName" placeholder="Full Name" required>
                                    <div class="validation-message" id="registerNameError"></div>
                                </div>
                                <div class="form-group">
                                    <input type="email" id="registerEmail" placeholder="Email" required>
                                    <div class="validation-message" id="registerEmailError"></div>
                                </div>
                                <div class="form-group">
                                    <input type="password" id="registerPassword" placeholder="Password" required>
                                    <div class="validation-message" id="registerPasswordError"></div>
                                </div>
                                <button type="submit" class="btn btn-primary btn-large" id="registerButton">
                                    <span class="button-text">Create Account</span>
                                    <div class="loading-spinner" style="display: none"></div>
                                </button>
                            </form>
                        </div>
                    </div>

                    <div class="demo-section animate-fadeInUp" style="animation-delay: 1s">
                        <button id="startDemo" class="btn btn-outline btn-large hover-lift">Try Demo</button>
                        <div class="data-actions">
                            <button id="importData" class="btn btn-outline btn-small hover-lift">Import Data</button>
                            <input type="file" id="importFile" accept=".json" style="display: none;">
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="main-footer animate-fadeInUp" style="animation-delay: 1.2s">
            <div class="footer-content">
                <div class="footer-info">
                    <p>Made with ❤️ by <a href="mailto:sambradhanbartau@gmail.com">sambradhanbartau@gmail.com</a></p>
                </div>
                <div class="social-links">
                    <a href="https://github.com" target="_blank" class="social-link hover-lift">
                        <i class="fab fa-github"></i>
                        GitHub
                    </a>
                    <a href="https://instagram.com" target="_blank" class="social-link hover-lift">
                        <i class="fab fa-instagram"></i>
                        Instagram
                    </a>
                    <a href="https://facebook.com" target="_blank" class="social-link hover-lift">
                        <i class="fab fa-facebook"></i>
                        Facebook
                    </a>
                </div>
            </div>
        </footer>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer" class="notification-container"></div>

    <script src="assets/js/user-manager.js"></script>
    <script src="assets/js/progress.js"></script>
    <script src="assets/js/animations.js"></script>
    <script>
        // Initialize animations
        document.addEventListener('DOMContentLoaded', function() {
            // Animate staggered items
            const staggerItems = document.querySelectorAll('.stagger-item');
            staggerItems.forEach(item => {
                item.classList.add('animate');
            });

            // Typewriter effect
            const typewriterElement = document.querySelector('.typewriter');
            if (typewriterElement) {
                typewriterElement.style.animation = 'typewriter 3s steps(40) 1s both, blink 0.8s infinite';
            }
        });

        // Check if user has existing progress to continue
        function checkContinueProgress() {
            const user = getCurrentUser();
            if (user) {
                const progress = progressTracker.getProgress();
                const totalCompleted = progress.completedLevels.html.length + 
                                     progress.completedLevels.css.length + 
                                     progress.completedLevels.js.length;
                
                if (totalCompleted > 0) {
                    const continueSection = document.getElementById('continueSection');
                    const continueButton = document.getElementById('continueButton');
                    
                    continueSection.style.display = 'block';
                    continueButton.textContent = `Continue (${totalCompleted} levels completed)`;
                }
            }
        }

        // Show validation error
        function showValidationError(fieldId, message) {
            const errorElement = document.getElementById(fieldId + 'Error');
            const inputElement = document.getElementById(fieldId);
            
            if (errorElement && inputElement) {
                errorElement.textContent = message;
                errorElement.style.display = 'block';
                inputElement.classList.add('error');
                
                // Add shake animation
                inputElement.classList.add('animate-shake');
                setTimeout(() => {
                    inputElement.classList.remove('animate-shake');
                }, 500);
            }
        }

        // Clear validation error
        function clearValidationError(fieldId) {
            const errorElement = document.getElementById(fieldId + 'Error');
            const inputElement = document.getElementById(fieldId);
            
            if (errorElement && inputElement) {
                errorElement.textContent = '';
                errorElement.style.display = 'none';
                inputElement.classList.remove('error');
            }
        }

        // Show loading state
        function setLoading(button, isLoading) {
            const buttonText = button.querySelector('.button-text');
            const spinner = button.querySelector('.loading-spinner');
            
            if (isLoading) {
                button.disabled = true;
                buttonText.style.opacity = '0';
                spinner.style.display = 'block';
            } else {
                button.disabled = false;
                buttonText.style.opacity = '1';
                spinner.style.display = 'none';
            }
        }

        // Show notification
        function showNotification(message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            notification.className = `notification notification-${type} animate-fadeInRight`;
            notification.innerHTML = `
                <div class="notification-content">
                    <i class="notification-icon ${getNotificationIcon(type)}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            container.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('animate-fadeInRight');
                setTimeout(() => {
                    notification.remove();
                }, 3000);
            }, 100);
        }

        function getNotificationIcon(type) {
            switch (type) {
                case 'success': return 'fas fa-check-circle';
                case 'error': return 'fas fa-exclamation-circle';
                case 'warning': return 'fas fa-exclamation-triangle';
                default: return 'fas fa-info-circle';
            }
        }

        // Auth tabs functionality
        document.querySelectorAll('.auth-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
                
                tab.classList.add('active');
                document.getElementById(tab.dataset.tab + 'Form').classList.add('active');
                
                // Clear validation errors when switching tabs
                clearAllValidationErrors();
            });
        });

        // Real-time validation
        document.getElementById('registerName').addEventListener('input', (e) => {
            if (!validateName(e.target.value)) {
                showValidationError('registerName', 'Name must be at least 2 characters');
            } else {
                clearValidationError('registerName');
            }
        });

        document.getElementById('registerEmail').addEventListener('input', (e) => {
            if (!validateEmail(e.target.value)) {
                showValidationError('registerEmail', 'Please enter a valid email address');
            } else {
                clearValidationError('registerEmail');
            }
        });

        document.getElementById('registerPassword').addEventListener('input', (e) => {
            if (!validatePassword(e.target.value)) {
                showValidationError('registerPassword', 'Password must be at least 6 characters');
            } else {
                clearValidationError('registerPassword');
            }
        });

        function clearAllValidationErrors() {
            ['registerName', 'registerEmail', 'registerPassword', 'loginEmail', 'loginPassword'].forEach(field => {
                clearValidationError(field);
            });
        }

        // Form submissions
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const loginButton = document.getElementById('loginButton');
            
            // Basic validation
            if (!email || !password) {
                showNotification('Please fill in all fields', 'error');
                return;
            }
            
            setLoading(loginButton, true);
            
            try {
                const user = await loginUser(email, password);
                setCurrentUser(user);
                showNotification(`Welcome back, ${user.name}!`, 'success');
                
                setTimeout(() => {
                    window.location.href = 'Code-X.html';
                }, 1000);
                
            } catch (error) {
                showNotification(error.message, 'error');
                setLoading(loginButton, false);
            }
        });

        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const registerButton = document.getElementById('registerButton');
            
            // Validation
            if (!validateName(name)) {
                showValidationError('registerName', 'Name must be at least 2 characters');
                return;
            }
            if (!validateEmail(email)) {
                showValidationError('registerEmail', 'Please enter a valid email address');
                return;
            }
            if (!validatePassword(password)) {
                showValidationError('registerPassword', 'Password must be at least 6 characters');
                return;
            }
            
            setLoading(registerButton, true);
            
            try {
                const user = await registerUser(name, email, password);
                setCurrentUser(user);
                showNotification(`Account created successfully! Welcome, ${user.name}!`, 'success');
                
                setTimeout(() => {
                    window.location.href = 'Code-X.html';
                }, 1000);
                
            } catch (error) {
                showNotification(error.message, 'error');
                setLoading(registerButton, false);
            }
        });

        // Continue button
        document.getElementById('continueButton').addEventListener('click', () => {
            window.location.href = 'Code-X.html';
        });

        // Demo button
        document.getElementById('startDemo').addEventListener('click', () => {
            const userId = 'demo_user_' + Date.now();
            const user = {
                id: userId,
                name: 'Demo User',
                email: 'demo@codex.com',
                joined: new Date().toISOString(),
                demo: true
            };
            
            setCurrentUser(user);
            userManager.initializeUserFolder(user);
            showNotification('Demo session started!', 'info');
            
            setTimeout(() => {
                window.location.href = 'Code-X.html';
            }, 500);
        });

        // Import data functionality
        document.getElementById('importData').addEventListener('click', () => {
            document.getElementById('importFile').click();
        });

        document.getElementById('importFile').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (file) {
                try {
                    const user = await importUserData(file);
                    setCurrentUser(user);
                    showNotification('Data imported successfully!', 'success');
                    
                    setTimeout(() => {
                        window.location.href = 'Code-X.html';
                    }, 1000);
                    
                } catch (error) {
                    showNotification('Error importing data: ' + error.message, 'error');
                }
            }
        });

        // Check if user already exists and show continue option
        window.addEventListener('load', () => {
            checkContinueProgress();
        });
    </script>
</body>
</html>